<h1><%= current_user.first_name %></h1>

<!-- Informations utilisateur -->
<div class="user-info">
  <%= current_user.email %><br>
  <%= current_user.city&.name %><br>
  <%= current_user.role %><br>
</div>

<!-- Informations spécifiques aux architectes -->
<% if user_is_architect_with_data? %>
  <div class="architect-info">
    <div class="specializations">
      <% current_user.architect.specializations.each do |specialization| %>
        <span class="specialization-tag"><%= specialization.name %></span>
      <% end %>
    </div>
    
    <% if current_user.architect.degree_names_array.any? %>
      <div class="degrees">
        <p><strong>Diplômes :</strong></p>
        <% current_user.architect.degree_names_array.each do |degree| %>
          <span class="degree-tag"><%= degree %></span>
        <% end %>
      </div>
    <% end %>
    
    <% if current_user.architect.description.present? %>
      <p><strong>Description :</strong> <%= current_user.architect.description %></p>
    <% end %>
  </div>
<% end %>

<!-- Avatar -->
<div class="user-avatar-section">
  <%= user_avatar_or_default %>
</div>

<!-- Actions sur la photo -->
<div class="profil-photo-actions">
  <%= form_tag user_avatars_path(current_user), multipart: true do %>
    <label for="avatar_input" class="avatar-button">Modifier l'avatar</label>
    <%= file_field_tag :avatar, id: "avatar_input", style: "display: none;" %>
    <%= submit_tag "mettre à jour", id: "profil-submit_button", style: "display: none;" %>
  <% end %>
</div>

<!-- Actions du profil -->
<div class="profil-actions">
  <%= link_to "Modifier", edit_user_path(@user) %>
  <%= form_with url: user_registration_path, method: :delete, local: true do %>
    <%= submit_tag "Supprimer mon compte", class: "profil-delete-account", 
        data: { confirm: "Êtes-vous sûr de vouloir supprimer votre compte ?" } %>
  <% end %>
</div>

<!-- Sections des projets -->
<% project_status_sections.each do |section| %>
  <% projects = projects_by_status(section[:status]) %>
  <% if projects.any? %>
    <div class="profil-section">
      <h3><%= section[:title] %></h3>
      <% projects.each do |project| %>
        <div class="project-item">
          <%= project.description %>
          <span class="project-status"><%= project.status %></span>
        </div>
      <% end %>
    </div>
  <% end %>
<% end %>

<!-- Portfolio pour les architectes -->
<% if user_is_architect_with_data? && current_user.architect.portfolio.present? %>
  <div class="profil-section">
    <h3>Portfolio</h3>
    <% current_user.architect.portfolios.sample(rand(1..3)).each do |project| %>
      <div class="portfolio-item">
        <h4><%= project.project_title %></h4>
        <p><%= truncate(project.project_description, length: 100) %></p>
      </div>
    <% end %>
  </div>
<% end %>

